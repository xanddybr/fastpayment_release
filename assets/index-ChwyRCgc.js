(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const e of o)if(e.type==="childList")for(const a of e.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const e={};return o.integrity&&(e.integrity=o.integrity),o.referrerPolicy&&(e.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?e.credentials="include":o.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function s(o){if(o.ep)return;o.ep=!0;const e=n(o);fetch(o.href,e)}})();const c=document.querySelector("#step-selection"),i=document.querySelector("#step-1"),m=document.querySelector("#step-2"),u=document.querySelector("#login");document.querySelector("#user-name");document.querySelector("#user-phone");document.querySelector("#email");document.querySelector("#otp-code");document.querySelector("#btn-send-otp");document.querySelector("#btn-verify-otp");document.querySelector("#message");const h=document.querySelector("#modal-container");document.querySelector("#modal-content");document.querySelector("#modal-title");document.querySelector("#modal-body");const f=document.querySelector("#close-modal"),p=()=>{const t=window.location.pathname.replace(/^\/[^\/]+/,"")||"/";if(t==="/login")l(),u?.classList.remove("hidden");else if(t!=="/"&&t!==""){const n=t.replace("/","");l(),c.classList.remove("hidden"),d(n)}else l(),c.classList.remove("hidden"),d()},l=()=>{[c,i,m,u].forEach(r=>r?.classList.add("hidden"))};f.addEventListener("click",()=>h.classList.add("hidden"));window.selectEvent=(r,t)=>{c.classList.add("hidden"),i.classList.remove("hidden");const n=i.querySelector("h2");n&&(n.textContent=`Inscri√ß√£o: ${t}`)};const d=async(r="")=>{const t=document.querySelector("#events-container");t.innerHTML="Carregando eventos...";try{const n=r?`http://localhost:8080/api/schedules?slug=${r}`:"http://localhost:8080/api/schedules",o=await(await fetch(n)).json();if(o.length===0){t.innerHTML='<p class="text-center">Nenhum hor√°rio dispon√≠vel para este evento.</p>';return}t.innerHTML=o.map(e=>`
            <div class="bg-white border border-slate-200 p-5 rounded-2xl shadow-sm hover:border-blue-500 transition-all">
                <div class="flex justify-between items-start mb-4">
                    <h3 class="text-lg font-bold text-slate-800">${e.event_name}</h3>
                    <span class="text-xl font-black text-blue-600">R$ ${e.event_price}</span>
                </div>
                <div class="text-sm text-slate-600 mb-6">
                    <p>üìç Unidade: ${e.unit_name}</p>
                    <p>üìÖ Data: ${new Date(e.scheduled_at).toLocaleDateString("pt-BR")}</p>
                    <p class="font-bold text-amber-600">üë• Vagas: ${e.vacancies}</p>
                </div>
                <button onclick="selectEvent(${e.schedule_id}, '${e.event_name}')" 
                    class="w-full bg-slate-900 text-white font-bold py-3 rounded-xl hover:bg-blue-600 transition-all">
                    Selecionar
                </button>
            </div>
        `).join("")}catch{t.innerHTML='<p class="text-red-500 text-center">Erro ao carregar a agenda.</p>'}};window.makeLogin=async()=>{const r=document.querySelector("#admin-email"),t=document.querySelector("#admin-password");if(!r.value||!t.value){alert("Por favor, preencha todos os campos.");return}try{const n=await fetch("http://localhost:8080/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r.value,password:t.value})}),s=await n.json();n.ok&&s.status==="sucesso"?(alert(`Bem-vindo, ${s.user.name}!`),window.location.href="/agenda/"):alert(s.mensagem||"Erro ao realizar login.")}catch{alert("Erro ao conectar com o servidor administrativo.")}};window.addEventListener("popstate",p);p();
